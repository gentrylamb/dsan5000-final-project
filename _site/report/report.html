<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analyzing Bike Routes in Washington, DC: – DSAN-5000: Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/bike.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DSAN-5000: Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../report/report.html" aria-current="page"> 
<span class="menu-text">Report</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-technical-details" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Technical details</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-technical-details">    
        <li>
    <a class="dropdown-item" href="../technical-details/data-collection/main.html">
 <span class="dropdown-text">Data-collection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/data-cleaning/main.html">
 <span class="dropdown-text">Data-cleaning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/eda/main.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/unsupervised-learning/main.html">
 <span class="dropdown-text">Unsupervised Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/supervised-learning/main.html">
 <span class="dropdown-text">Supervised Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/progress-log.html">
 <span class="dropdown-text">Progress Log</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/llm-usage-log.html">
 <span class="dropdown-text">LLM usage Log</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective">Objective</a></li>
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings">Key Findings</a>
  <ul class="collapse">
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  <li><a href="#predicting" id="toc-predicting" class="nav-link" data-scroll-target="#predicting">Predicting</a></li>
  </ul></li>
  <li><a href="#methodology-overview" id="toc-methodology-overview" class="nav-link" data-scroll-target="#methodology-overview">Methodology Overview</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#unsupervised-learning" id="toc-unsupervised-learning" class="nav-link" data-scroll-target="#unsupervised-learning">Unsupervised Learning</a></li>
  <li><a href="#supervised-learning" id="toc-supervised-learning" class="nav-link" data-scroll-target="#supervised-learning">Supervised Learning</a></li>
  </ul></li>
  <li><a href="#societal-implications" id="toc-societal-implications" class="nav-link" data-scroll-target="#societal-implications">Societal Implications</a></li>
  <li><a href="#call-to-action" id="toc-call-to-action" class="nav-link" data-scroll-target="#call-to-action">Call to Action</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analyzing Bike Routes in Washington, DC:</h1>
<p class="subtitle lead">Clustering and Classification for Urban Insights</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Gentry Lamb <a href="mailto:gjl53@georgetown.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Georgetown University
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Chase Clemence <a href="mailto:cac499@georgetown.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Georgetown University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Exploring a new city can be an overwhelming experience, especially when navigating its unique traditions, attractions, and outdoor activities. For avid biking enthusiasts, this challenge is heightened by the need to find suitable bike paths to explore. Questions like <em>Which trails offer the best scenery around the city?</em> and <em>Which paths are most practical for commuting, shopping, or other daily activities?</em> naturally arise when diving into the biking landscape of an unfamiliar area.</p>
<p>Even for those less passionate about cycling, services like Lime, Capital Bikeshare, and others have made eBikes widely accessible, offering a convenient and sustainable way to explore the city. Biking, whether as a recreational activity or a mode of transportation, is a vital aspect of urban culture. Beyond its practical benefits, cycling also contributes to reducing carbon emissions, playing a critical role in a city’s environmental sustainability efforts.</p>
<p>For residents and visitors of Washington, DC, biking is an integral part of city life. However, identifying bike trails that align with personal goals—whether for leisure, fitness, or utility—can be a daunting task. This study aims to address that challenge by clustering bike trails based on their inherent qualities and predicting characteristics for new or unexplored paths.</p>
<p>We focused on a variety of trail attributes to inform our analysis. These included ratings for terrain difficulty, traffic levels, and scenic beauty. Additionally, we considered sentiment analysis, trail distances, and structural aspects such as whether a trail forms a loop. By leveraging these characteristics, our goal is to group similar bike paths together, providing users with actionable insights into which trails best meet their needs.</p>
</section>
<section id="objective" class="level2">
<h2 class="anchored" data-anchor-id="objective">Objective</h2>
<p>The primary goal of this research is to analyze and categorize the bike trails in Washington, DC, to provide valuable insights that help cyclists make informed decisions about their routes. By examining key characteristics of the trails, such as distance, terrain difficulty, traffic conditions, and scenic value, we aim to create a comprehensive understanding of the biking infrastructure in the city. The study specifically focuses on the objectives of trail clustering and predicting route attributes.</p>
<p>By employing different clustering algorithms, we attempt to group bike trails with similar characteristics such as distance, terrain, traffic and more. This will allow cyclists to easily identify trails that best match their preferences, whether they seek leisurely recreation or a physically demanding workout. Beyond just cyclists, grouping data can be used by city planners in addressing gaps in trail diversity when expanding trails to new areas. For example, if there are few trails catering to beginners with flat terrain and low traffic, planners can prioritize adding such routes to balance the network and make cycling more accessible.</p>
<p>We transitioned from clustering techniques to a focus on supervised learning methods with the objective of accurately predicting key qualities of bike trails. Specifically, we utilized decision trees to achieve this goal. Predictive modeling in this context offers significant potential to enhance the overall biking experience and address various practical needs. For instance, an effective model can predict trail sentiment — a measure that provides insight into factors such as the level of tourism or crowding on a trail. Cyclists seeking quieter routes can use these predictions to identify less busy trails, thereby tailoring their experience to personal preferences. Additionally, supervised learning can provide insights into the structural characteristics of a trail, such as whether it forms a loop. This type of information not only improves a cyclist’s understanding of a trail but also contributes to safety by helping riders make more informed decisions about their routes. Overall, our objective is to leverage supervised learning techniques to deliver actionable insights that optimize the biking experience and enhance trail accessibility, safety, and enjoyment.</p>
</section>
<section id="key-findings" class="level2">
<h2 class="anchored" data-anchor-id="key-findings">Key Findings</h2>
<section id="clustering" class="level3">
<h3 class="anchored" data-anchor-id="clustering">Clustering</h3>
<ul>
<li>Clustering results were subtle, and clear, actionable groupings were not identified.</li>
<li>K-Means showed the most promise, though the clusters lacked obvious interpretability.</li>
<li>Results suggest that current features may not fully capture trail distinctions; additional data could improve insights.</li>
<li>Incorporating user feedback or geospatial data might enhance the clustering process and provide more actionable results.</li>
</ul>
</section>
<section id="predicting" class="level3">
<h3 class="anchored" data-anchor-id="predicting">Predicting</h3>
<ul>
<li>A simple linear model predicted sentiment with roughly 86% success. However, it was deemed a poor fit for the data, having an R^2 value of 0.03.</li>
<li>Using a more advanced model, we successfully predicted the sentiment of previously unseen trails with over 95% accuracy (equivalent to a 4.7% error rate).</li>
<li>Predicting whether a trail forms a loop proved more challenging, with the model achieving an accuracy of around 78%.</li>
<li>Lastly, predicting the state in which a trail begins was particularly difficult, with the model reaching only 44% accuracy.</li>
</ul>
</section>
</section>
<section id="methodology-overview" class="level2">
<h2 class="anchored" data-anchor-id="methodology-overview">Methodology Overview</h2>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>To gain a comprehensive understanding of bike trails in Washington, DC, we gathered data from <a href="http://bikewashington.org/routes/index.htm">BikeWashington.org</a>, a detailed resource for bike trails in the region. The site includes a table of routes with information on names, descriptions, distances, and ratings for terrain, traffic, and scenery. Using web scraping techniques with browser automation tools, we efficiently processed this information for analysis, resulting in a dataset of 43 unique routes with six key attributes.</p>
<p>The dataset underwent a cleaning process to address redundant columns, missing values, and inconsistent category formats. Additionally, binary features were created, and sentiment analysis of route descriptions was performed, expanding the dataset to 15 attributes.</p>
<p>Exploratory Data Analysis (EDA) was conducted as the final step in data preparation. Techniques such as descriptive statistics, density plots, frequency analysis, and count plots were employed to understand the data better. EDA provided valuable insights into the dataset’s structure and helped identify relationships and patterns critical for subsequent clustering and modeling tasks.</p>
</section>
<section id="unsupervised-learning" class="level3">
<h3 class="anchored" data-anchor-id="unsupervised-learning">Unsupervised Learning</h3>
<p>Clustering the bike trails involved multiple steps to uncover patterns and groupings within the dataset, leveraging unsupervised learning techniques. Initially, we applied dimensionality reduction methods, such as Principal Component Analysis (PCA) and t-Distributed Stochastic Neighbor Embedding (t-SNE), to simplify the dataset while preserving its essential structure. PCA helped identify the optimal number of dimensions by capturing variance, whereas t-SNE provided a more nuanced visualization of potential clusters by maintaining local similarities. Both techniques informed the subsequent clustering steps, allowing us to visualize the data in reduced dimensions and better understand its structure.</p>
<p>Three primary clustering algorithms were then employed to group similar bike trails: K-Means, DBSCAN, and Hierarchical Clustering. K-Means, a partitioning method, was optimized using the Elbow and Silhouette methods to determine the appropriate number of clusters. This approach provided well balanced groups that logically appeared the best. The clusters formed by K-Means generally aligned with routes that shared common features, such as similar distances or ratings. The plot below illustrates the eight clusters formed by K-Means, projected onto the 2-D t-SNE space for ease of visualization.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/plots/k-means-cluster.png" class="img-fluid figure-img"></p>
<figcaption>K-Means Clustering Groups</figcaption>
</figure>
</div>
<p>DBSCAN, a density-based clustering method, allowed us to detect clusters of trails based on proximity and density, making it particularly useful for identifying outliers or trails that do not fit well into other groupings. While this ability is beneficial for excluding irrelevant data, it resulted in an uneven distribution of clusters. This highlights the sparsity of our data set, as we have a 15 dimensional vector space and only 43 points to fill it. Below displays the DBSCAN clusters represented in a 2-D space. Note that purple points represent “noise” or unassigned data in the DBSCAN algorithm.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/plots/dbscan-cluster.png" class="img-fluid figure-img"></p>
<figcaption>DBSCAN Clustering Groups</figcaption>
</figure>
</div>
<p>Finally, Hierarchical Clustering was implemented to create a framework of the groups clusters belonged to. Specifically, we used agglomerative clustering, or “bottom-up”, where each data point starts as its own cluster and is progressively merged with others to form larger clusters until all data points are grouped. This resulted in 18 different clusters as seen in the plot below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/plots/hier-cluster.png" class="img-fluid figure-img"></p>
<figcaption>Hierarchical Clustering Groups</figcaption>
</figure>
</div>
</section>
<section id="supervised-learning" class="level3">
<h3 class="anchored" data-anchor-id="supervised-learning">Supervised Learning</h3>
<p>Linear regression can be thought of as drawing a line of best fit through a set of data points to uncover the most accurate relationship between variables. It is one of the simplest and most interpretable models for making predictions. Using data from 43 bike trails in the DMV area, we explored the predictive power of a multiple linear regression model. Specifically, we aimed to predict the sentiment of a trail (the dependent variable) based on 10 independent variables: terrain rating, traffic rating, scenery rating, normalized distance in miles, unpaved, flat, workout, park, river, and loop. After training the model on 34 observations, we assessed its performance by evaluating both the error and the goodness-of-fit. While the model predicted trail sentiment reasonably well, it ultimately failed to capture the complexity of the data, making it a poor overall fit.</p>
<p>In contrast, regression trees rely on decision-based rules to create a branching structure of yes/no responses, leading to a specific outcome. We used a regression tree to predict sentiment using the same 10 independent variables. After training the tree on 34 observations and testing it on unseen data, we optimized its structure by experimenting with different parameters. The resulting tree outperformed the linear regression model, improving prediction accuracy by nearly 10%, demonstrating the superiority of regression trees in this context.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/plots/regression-tree-hyperparameter.png" class="img-fluid figure-img"></p>
<figcaption>Regression Hyperparameter Optimization</figcaption>
</figure>
</div>
<p>To predict whether a bike trail was a loop, we used a binary classification tree. Classification trees operate similarly to regression trees but predict discrete outcomes — in this case, whether a trail is a loop (1) or not (0). We optimized the tree’s parameters and trained it on 80% of the dataset. While the model achieved reasonable accuracy, there was significant room for improvement, indicating that additional data or alternative approaches might enhance performance.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/plots/binary-classification-tree.png" class="img-fluid figure-img"></p>
<figcaption>Binary Classification Tree</figcaption>
</figure>
</div>
<p>Finally, we used a multiclass classification tree to predict the state where each bike trail begins. Unlike binary classification trees, multiclass trees predict one of several possible categories — in this case, four unique state labels in our dataset. Following the same procedure as before, we optimized the tree’s parameters and trained it on 80% of the data. However, this model performed poorly in predicting the correct state, only slightly surpassing random guessing. This outcome highlighted the complexity of the task and the limitations of the current dataset and approach.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/plots/multiclass-classification-tree.png" class="img-fluid figure-img"></p>
<figcaption>Multiclass Classification Tree</figcaption>
</figure>
</div>
</section>
</section>
<section id="societal-implications" class="level2">
<h2 class="anchored" data-anchor-id="societal-implications">Societal Implications</h2>
<p>The results of the clustering methods revealed some groupings, but they were not particularly clear or immediately informative. Of the three methods used, K-Means produced the most interpretable results, with clusters aligning to some extent with trail features. However, the distinctions between clusters were subtle, and no definitive or obvious patterns emerged that could clearly segment trails into well-defined categories. While K-Means provided a structured grouping, these results should be approached cautiously, as the boundaries between clusters were not always intuitive or meaningful. This lack of clarity suggests that the features used in this analysis may not fully capture the nuances of trail characteristics or user preferences. Contrarily, the results suggest that clustering is possible, and with enhanced data, more concrete insights may be revealed.</p>
<p>So, although clustering results were not highly interpretable, they emphasize the need for comprehensive trail data to inform future planning efforts. These findings can inspire discussions on how urban infrastructure can better accommodate cyclists, promote sustainable commuting, and encourage healthier lifestyles. We were largely limited by available data on bike routes in DC. Additional features such as user demographics, trail usage patterns, economic data, and even community input would greatly improve the data and ensuing analysis. With richer data, future iterations of this project could generate deeper insights, making the findings more actionable and beneficial for urban development and the biking community.</p>
<p>Improved biking infrastructure not only benefits individual riders but also fosters broader societal gains, including reduced traffic congestion, lower carbon emissions, and enhanced public health. By addressing challenges such as unclear clustering patterns, city planners can refine their approach to ensure that bike trails are designed to meet the community’s diverse needs.</p>
</section>
<section id="call-to-action" class="level2">
<h2 class="anchored" data-anchor-id="call-to-action">Call to Action</h2>
<p>The findings of this project highlight an exciting opportunity for city planners, policymakers, and community stakeholders to take meaningful steps toward improving biking infrastructure in Washington, DC. As biking continues to grow in popularity as a sustainable and healthy mode of transportation, it is imperative to ensure that trails are accessible, safe, and enjoyable for all types of riders. While the current analysis provides some insights, the clustering results reveal that further refinements are necessary to better classify and understand trail characteristics.</p>
<p>Moving forward, city planners should consider investing in more comprehensive data collection efforts. Gathering detailed information on trail usage, user demographics, and rider feedback would enhance the ability to make meaningful clusters, which would in turn help tailor biking infrastructure to community needs. Collaborating with local organizations or even biking advocates could provide valuable perspectives and real-time feedback on trail usability.</p>
<p>Ultimately, this project underlines the importance of continual research and innovation in urban planning. Leveraging advanced analytical and statistical methods alongside community-focused approaches will help shape a biking infrastructure that better supports the city. By taking these actions, DC can set an example for other cities striving to become more bike-friendly and environmentally conscious.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This study highlights the growing importance of well-planned biking infrastructure in urban areas like Washington, DC. While the clustering results were not highly conclusive, they emphasize the potential for data-driven approaches to improve how bike trails are understood, categorized, and enhanced. Predictive modeling demonstrated the capability to estimate trail characteristics like sentiment and loop formation, though the models’ performance varied depending on the task.</p>
<p>The analysis reveals the need for richer and more diverse data to generate actionable insights. By prioritizing comprehensive data collection and leveraging community input, city planners can better meet the needs of diverse cyclists and create a more connected, bike-friendly urban environment.</p>
<p>These findings encourage stakeholders to act by refining data collection, collaborating with the community, and prioritizing improvements in underutilized areas. With these efforts, Washington, DC, can not only enhance its biking experience but also set a benchmark for urban cycling infrastructure nationwide.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>